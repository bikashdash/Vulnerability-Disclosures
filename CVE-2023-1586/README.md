# CVE-2023-1586

## Description

TBD

## Impact

TBD

## Steps to reproduce

1. Copy `AswRestoreFileExploit.dll` to target virtual machine where Avast Free Anti-Virus is already installed;
2. Run `powershell.exe` and call `rundll32.exe` with DLL `AswRestoreFileExploit.dll`, exported function `Exploit` 
and two arguments: 1st â€“ the name of a file that contains content the file specified by 2nd argument, 2nd - the name 
of the file being created. Example of `rundll32` command line:
```
rundll32 .\AswRestoreFileExploit.dll,Exploit C:\Users\User\Desktop\PoC\pwn.txt C:\Windows\System32\poc.dll
```
3. Make sure file passed as 2nd argument was successfully created and contains content of file passed as 1st argument.

> NOTE: The exploit can only create new file in arbitrary location and cannot overwrite already existing files.

## Resolution

According to the [vendor's advisories](https://support.norton.com/sp/static/external/tools/security-advisories.html) 
this issue fixed in Avast and AVG Antivirus for Windows since version 22.11 released on 16 November 2022.

## Disclosure Timeline

- 25-06-2022
Initial report sent to Avast.

- 03-10-2022
Initial response from Avast stating they got displaced my report and are now being reviewed it.

- 19-10-2022
Avast triaged the issue reported as a valid issue and redirected me to the 
[NortonLifeLock](https://www.nortonlifelock.com/us/en/contact-us/report-a-security-vulnerability/) bug bounty portal.

- 27-10-2022
Norton triaged the issue reported as a valid issue and is starting work on a fix.

- 15-12-2022
Norton released patched version of product and is requesting retest of the implemented fix.

- 09-02-2023
I confirmed that fix is correct.

- 19-04-2023
Norton registered CVEs and published [advisory](https://support.norton.com/sp/static/external/tools/security-advisories.html).

## References

[CVE-2023-1586](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1586)

[Write-Up](https://the-deniss.github.io/posts/avast-privileged-arbitrary-file-create-on-restore/)

[Norton Advisory](https://support.norton.com/sp/static/external/tools/security-advisories.html)
