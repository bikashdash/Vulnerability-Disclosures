# CVE-2023-1585 & CVE-2023-1587

## Description

TBD

## Impact

TBD

## Steps to reproduce

1. Copy `AswQuarantineFileExploit.dll` to target virtual machine where Avast Free Anti-Virus is already installed;
2. Run `powershell.exe` and call `rundll32.exe` with DLL `AswQuarantineFileExploit.dll`, exported function `Exploit` 
and two arguments: 1st â€“ the name of a file that replaces the file specified by 2nd argument, 2nd - the name of the 
file being replaced. Example of `rundll32` command line:
```
rundll32 .\AswQuarantineFileExploit.dll,Exploit C:\Users\User\Desktop\PoC\pwn.txt C:\Windows\System32\aadjcsp.dll
```
> NOTE: The exploit can as well create file if it does not exist and overwrite files owned by `TrustedInstaller` 
> and accessible only for `READ` for SYSTEM account.

3. Make sure file passed as 2nd argument was successfully replaced with file passed as 1st argument.

## Resolution

According to the [vendor's advisories](https://support.norton.com/sp/static/external/tools/security-advisories.html) 
these issues fixed in Avast and AVG Antivirus for Windows since version 22.11 released on 16 November 2022.

## Disclosure Timeline

25-06-2022 Initial report sent to Avast.

03-10-2022 Initial response from Avast stating they got displaced my report and are now being reviewed it.

19-10-2022 Avast triaged the issue reported as a valid issue and redirected me to the NortonLifeLock bug bounty portal.

27-10-2022 Norton triaged the issue reported as a valid issue and is starting work on a fix.

15-12-2022 Norton released patched version of product and is requesting retest of the implemented fix.

09-02-2023 I reported to Norton that fixes were incomplete and should be reworked.

02-03-2023 I retested new fixes and approved they were correct.

19-04-2023 Norton registered CVEs and published advisories.

26-04-2023 Write-up has been published.

## References

[CVE-2023-1585](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1585)

[CVE-2023-1587](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1587)

[Write-Up](https://the-deniss.github.io/posts/2023/04/26/avast-privileged-arbitrary-file-create-on-quarantine.html)

[Norton Advisories](https://support.norton.com/sp/static/external/tools/security-advisories.html)
